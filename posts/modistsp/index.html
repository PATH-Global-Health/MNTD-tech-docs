<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.35">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Justin Millar">
<meta name="dcterms.date" content="2022-07-14">

<title>PATH Malaria &amp; NTDs Technical Docs - Downloading MODIS raster data in R with MODIStsp</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=325231266"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', '325231266', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../../styles.scss">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PATH Malaria &amp; NTDs Technical Docs</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/PATH-Global-Health/MNTD-tech-docs"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/PATHMalaria"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Downloading MODIS raster data in R with MODIStsp</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">remote sensing</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">raster</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Justin Millar </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 14, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#installation-and-setup" id="toc-installation-and-setup" class="nav-link active" data-scroll-target="#installation-and-setup">Installation and setup</a></li>
  <li><a href="#interactive-interface" id="toc-interactive-interface" class="nav-link" data-scroll-target="#interactive-interface">Interactive interface</a></li>
  <li><a href="#programmatic-mode" id="toc-programmatic-mode" class="nav-link" data-scroll-target="#programmatic-mode">Programmatic mode</a>
  <ul class="collapse">
  <li><a href="#defining-product-layers-and-sensor" id="toc-defining-product-layers-and-sensor" class="nav-link" data-scroll-target="#defining-product-layers-and-sensor">Defining product, layers, and sensor</a></li>
  <li><a href="#defining-spatial-extent-and-projection" id="toc-defining-spatial-extent-and-projection" class="nav-link" data-scroll-target="#defining-spatial-extent-and-projection">Defining spatial extent and projection</a></li>
  <li><a href="#defining-time-frame-and-user-credentials" id="toc-defining-time-frame-and-user-credentials" class="nav-link" data-scroll-target="#defining-time-frame-and-user-credentials">Defining time frame and user credentials</a></li>
  <li><a href="#loading-and-plotting-data" id="toc-loading-and-plotting-data" class="nav-link" data-scroll-target="#loading-and-plotting-data">Loading and plotting data</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="installation-and-setup" class="level2">
<h2 class="anchored" data-anchor-id="installation-and-setup">Installation and setup</h2>
<p>The <a href="https://docs.ropensci.org/MODIStsp/"><code>MODIStsp</code> package</a> provides an R interface to the raster images derived from MODIS Land Products data. This package provides an interactive user interface, as well as functions for programmatic queries for the time-series rasters. Note that this library requires and active internet connection.</p>
<p>Before installing the package, be sure that you have an NASA EarthData account, which is free and can be created at <a href="https://urs.earthdata.nasa.gov/home" class="uri">https://urs.earthdata.nasa.gov/home</a>.</p>
<p>Once you have an active account, you can install the MODIStsp package directly from CRAN.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"MODIStsp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also install the experimental version of the package from the <a href="https://github.com/ropensci/MODIStsp/">MODIStsp Github repository</a>. The package has <a href="https://docs.ropensci.org/MODIStsp/">excellent documentation</a>, including multiple example articles. The following sections will briefly demonstrate the interactive and non-interactive modes, but be sure to check the package documentation for more details!</p>
</section>
<section id="interactive-interface" class="level2">
<h2 class="anchored" data-anchor-id="interactive-interface">Interactive interface</h2>
<p>The main function in the <code>MODIStsp</code> package is called <code>MODIStsp()</code>. By default, running this function with any additional input will launch the interactive graphic user interface (GUI) in you web browser.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MODIStsp)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Launch graphic interface </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">MODIStsp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="dashboard.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Screenshot of MODIStsp graphic user interface</figcaption><p></p>
</figure>
</div>
<p>This GUI will lead to step-by-step through the selection, processing, and outputting workflow.</p>
<p>Starting with the “Products and Layers” section, choose which MODIS product and remote sensed layers you wish to download. Multiple layers can be included for a selected product category. The ? mark icon provide useful information on the various inputs, and the book button next to the Product Name menu will link to the NASA product documentation page, which will contains further details for that product including units, resolution, and aggregation scale factor.</p>
<p>Once the products layers have been selected, move onto the “Spatial/Temporal option” section. Here you can select the time range, projection, and spatial extent. Spatial parameters can be defined by tile selection, bounding box, uploading a shapefile, or by drawing on an interactive map.</p>
<p>Next, move to the “Output Format and Folders” section. This is where you will provide your NASA EarthData user information, and set the destination for your output files. You can use the “Browse” button to selection the output folder on your computer.</p>
<p>Once you have filled out each section you can press the “Run MODIStsp” button on the left menu. This will execute your query and process the download. Download times will depend on your input parameters and internet connection.</p>
</section>
<section id="programmatic-mode" class="level2">
<h2 class="anchored" data-anchor-id="programmatic-mode">Programmatic mode</h2>
<p>While the interactive GUI approach may be useful for individual data pulls, you may want to programmatic define your download parameters. This is especially useful to embed within code for analysis, as it serves as documentation and improves reproducibility.</p>
<p>The package documentation also provides an <a href="https://docs.ropensci.org/MODIStsp/articles/noninteractive_execution.html">article for using the programmatic approach</a>. This uses the same <code>MODIStsp()</code> function, expect now we have to provide the inputs that we would have used in the GUI directly into the function.</p>
<p>Here is an example for getting monthly NDVI and EVI rasters for Zambia 2021. First we still start by downloading a shapefile for Zambia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)         <span class="co"># File management package</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)         <span class="co"># Spatial data package</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)     <span class="co"># Raster data package</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MODIStsp)   <span class="co"># MODIS package</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  <span class="co"># Data process and viz</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a temporary folder for downloaded files</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>dest <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Download shapefile for Zambia</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>shp_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://raw.githubusercontent.com/"</span>, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"PATH-Global-Health/geometries/main/adm0/Zambia/adm0.json"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="at">url =</span> shp_url, <span class="at">destfile =</span> <span class="fu">path</span>(dest, <span class="st">"Zambia.json"</span>))</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>shp <span class="ot">&lt;-</span> <span class="fu">st_geometry</span>(<span class="fu">st_read</span>(<span class="fu">path</span>(dest, <span class="st">"Zambia.json"</span>), <span class="at">quiet =</span> T))</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this example I created a temporary folder (using the <code>tempdir()</code>) and saved it’s “path” into an object called <code>dest</code>. This is where we will download rasters and other metadata files. You can swap <code>tempdir()</code> with a file path to a location on your computer.</p>
<p>Next, use the <code>MODIStsp()</code> function to download rasters by setting each parameter within the function. Here is the code for download monthly NDVI and EVI raster for 2021 at a 1 kilometer resolution.</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Time consuming function
</div>
</div>
<div class="callout-body-container callout-body">
<p>This function may take several minutes or longer to run depending on the number of rasters, their sizes and resolutions, and your internet. Setting <code>parallel = TRUE</code> can help speed up the download.</p>
</div>
</div>
<div class="cell">

</div>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-10_fb7fb9708ab79b2cafeab48fe163ecc8">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># user and pass are set based on NASA EarthData account credentials</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">MODIStsp</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gui             =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">out_folder      =</span> dest,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">selprod         =</span> <span class="st">"Vegetation_Indexes_Monthly_1Km (M*D13A3)"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">bandsel         =</span> <span class="fu">c</span>(<span class="st">"NDVI"</span>, <span class="st">"EVI"</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">sensor          =</span> <span class="st">"Terra"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">spatmeth        =</span> <span class="st">"file"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">spafile         =</span> <span class="fu">path</span>(dest, <span class="st">"Zambia.json"</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_proj     =</span> <span class="st">"+proj=longlat +datum=WGS84 +no_defs"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_date      =</span> <span class="st">"2021.01.01"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_date        =</span> <span class="st">"2021.12.31"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">user            =</span> user,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">password        =</span> pass,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose         =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel        =</span> <span class="cn">TRUE</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are a lot of details, but remeber that we have to supply everything that we would have clicked in the GUI. The benefit of this approach is that we can save it in a script, which means the our process is documented and repeatable.</p>
<section id="defining-product-layers-and-sensor" class="level3">
<h3 class="anchored" data-anchor-id="defining-product-layers-and-sensor">Defining product, layers, and sensor</h3>
<p>We need to tell R which <a href="https://modis.gsfc.nasa.gov/data/dataprod/">MODIS product</a> and which specific layers from that product we want to download. We do this using the <code>selprod</code> and <code>bandsel</code> arguments, respectively. We can only select one MODIS product at a time, but we can download multiple layers from that product at once.</p>
<p>You can use the <code>MODIStsp_get_prodnames()</code> function to list the available MODIS products, and the <code>MODIStsp_get_prodlayers()</code> function to get a list of available layers.</p>
<p>Finally, we can choose to select layers from either the <a href="https://terra.nasa.gov/about/terra-instruments">Terra</a> or <a href="https://oceancolor.gsfc.nasa.gov/data/aqua/">Aqua</a> sensors. The default is to pull from both (if both are available), which is fine but may be unnecessary and will take extra time then selecting an individual sensor.</p>
</section>
<section id="defining-spatial-extent-and-projection" class="level3">
<h3 class="anchored" data-anchor-id="defining-spatial-extent-and-projection">Defining spatial extent and projection</h3>
<p>Similar to the GUI, there are multiple options for defining the spatial extent, include using a local shapefile (<code>"file"</code>), the bounding box of a spatial object (<code>"bbox"</code>), or specific tile number from the <a href="https://modis-land.gsfc.nasa.gov/MODLAND_grid.html">MODIS Grid</a> (<code>"tile"</code>). While each approach is viable, I’ve had the most success with the <code>"file"</code> method.</p>
<p>We can also set the geographic projection for the rasters using the <code>output_proj</code> argument. This is helpful if the default projection from MODIS does not match other spatial data, such as our shapefile.</p>
</section>
<section id="defining-time-frame-and-user-credentials" class="level3">
<h3 class="anchored" data-anchor-id="defining-time-frame-and-user-credentials">Defining time frame and user credentials</h3>
<p>Next, we state the time frame for our raster pulls. The number of raster files that will be download within this time frame will depend on the selected product. The input format is a character string with the format <code>"YYYY-MM-DD"</code>, not an <code>as.Date()</code> or lubridate-style date.</p>
<p>We also need to supply your username and password for your NASA EarthData account. In this example, I save this information into variables called <code>user</code> and <code>pass</code>, which I defined directly in the R Console rather than in my script, that way any personal credential information is not saved within my script.</p>
<p>Finally, there are many additional arguments that can be included. Some helpful ones are <code>verbose = TRUE</code>, which will print information in your Console during through downloading, and <code>parallel = TRUE</code>, which will speed up the download by using multiple CPU cores.</p>
</section>
<section id="loading-and-plotting-data" class="level3">
<h3 class="anchored" data-anchor-id="loading-and-plotting-data">Loading and plotting data</h3>
<p>Let’s data a look at the files in our <code>dest</code> output folder. Since we defined the extent using a shapefile called <code>Zambia.json</code>, the <code>MODIStsp()</code> function created a new folder called <code>Zambia</code> and stored all the of results here. These are all of the raster files that we downloaded.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir_ls</span>(<span class="fu">path</span>(dest, <span class="st">"Zambia"</span>), <span class="at">recurse =</span> T, <span class="at">type =</span> <span class="st">"file"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">path_rel</span>(dest)  <span class="co"># This function returns the "relative" path</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zambia/MODIStsp_2022-07-26.json
Zambia/VI_Monthly_1Km_v6/EVI/MOD13A3_EVI_2021_001.tif
Zambia/VI_Monthly_1Km_v6/EVI/MOD13A3_EVI_2021_032.tif
Zambia/VI_Monthly_1Km_v6/EVI/MOD13A3_EVI_2021_060.tif
Zambia/VI_Monthly_1Km_v6/EVI/MOD13A3_EVI_2021_091.tif
Zambia/VI_Monthly_1Km_v6/EVI/MOD13A3_EVI_2021_121.tif
Zambia/VI_Monthly_1Km_v6/EVI/MOD13A3_EVI_2021_152.tif
Zambia/VI_Monthly_1Km_v6/EVI/MOD13A3_EVI_2021_182.tif
Zambia/VI_Monthly_1Km_v6/EVI/MOD13A3_EVI_2021_213.tif
Zambia/VI_Monthly_1Km_v6/EVI/MOD13A3_EVI_2021_244.tif
Zambia/VI_Monthly_1Km_v6/EVI/MOD13A3_EVI_2021_274.tif
Zambia/VI_Monthly_1Km_v6/EVI/MOD13A3_EVI_2021_305.tif
Zambia/VI_Monthly_1Km_v6/EVI/MOD13A3_EVI_2021_335.tif
Zambia/VI_Monthly_1Km_v6/NDVI/MOD13A3_NDVI_2021_001.tif
Zambia/VI_Monthly_1Km_v6/NDVI/MOD13A3_NDVI_2021_032.tif
Zambia/VI_Monthly_1Km_v6/NDVI/MOD13A3_NDVI_2021_060.tif
Zambia/VI_Monthly_1Km_v6/NDVI/MOD13A3_NDVI_2021_091.tif
Zambia/VI_Monthly_1Km_v6/NDVI/MOD13A3_NDVI_2021_121.tif
Zambia/VI_Monthly_1Km_v6/NDVI/MOD13A3_NDVI_2021_152.tif
Zambia/VI_Monthly_1Km_v6/NDVI/MOD13A3_NDVI_2021_182.tif
Zambia/VI_Monthly_1Km_v6/NDVI/MOD13A3_NDVI_2021_213.tif
Zambia/VI_Monthly_1Km_v6/NDVI/MOD13A3_NDVI_2021_244.tif
Zambia/VI_Monthly_1Km_v6/NDVI/MOD13A3_NDVI_2021_274.tif
Zambia/VI_Monthly_1Km_v6/NDVI/MOD13A3_NDVI_2021_305.tif
Zambia/VI_Monthly_1Km_v6/NDVI/MOD13A3_NDVI_2021_335.tif
Zambia/VI_Monthly_1Km_v6/Time_Series/RData/Terra/EVI/MOD13A3_EVI_1_2021_335_2021_RData.RData
Zambia/VI_Monthly_1Km_v6/Time_Series/RData/Terra/NDVI/MOD13A3_NDVI_1_2021_335_2021_RData.RData</code></pre>
</div>
</div>
<p>Here we can see more of the default naming conventions. Inside the <code>Zambia</code> folder we have a JSON file the contains the details for the API call that downloaded our raster, and a folder called <code>VI_Monthly_1Km_v6</code>, which matches our selected MODIS product. Inside <code>VI_Monthly_1Km_v6</code> there are two folders, <code>NDVI</code> and <code>EVI</code>, which are the bandnames for our selected layers. Inside these subfolders, there are 12 <code>.tif</code> raster files. The naming convention for these files is <code>PRODNAME_PRODLAYER_YYYY_DDD.tif</code> where <code>DDD</code> refers to the Julian calendar date (1 to 365) for the starting date for that layer.</p>
<p>There is also a <code>Time_Series</code> subfolder, which contains a <code>.RData</code> file containing a RasterStack object for each layer. Loading this file with <code>load()</code> will an load this object with the default name of <code>raster_ts</code> .</p>
<p>We can load individual rasters into R, and use them from plotting and/or further analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load one raster file from the "NDVI" folder</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>rst <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">dir_ls</span>(<span class="fu">path</span>(dest, <span class="st">"Zambia"</span>, <span class="st">"VI_Monthly_1Km_v6"</span>, <span class="st">"NDVI"</span>))[<span class="dv">1</span>])</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rst)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shp, <span class="at">add =</span> T, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You might notice that the values for this raster are much larger than we would expect for NDVI (which ranges from -1 to 1). If we look in the <a href="https://lpdaac.usgs.gov/product_search/">MODIS Data Catalog</a> for the <a href="https://lpdaac.usgs.gov/products/mod13a3v006/">documentation on this layer</a> we can see that the scale factor for the NDVI layer is 0.0001, meaning that we will want to multiple the raster values by this constant to return the actual values. Next time we pull this raster layer using <code>MODIStsp()</code> we may want to set the <code>scale_val</code> argument to 0.0001 to make this adjustment automatically.</p>
<p>Finally, since all of the rasters are pulled using the same criteria (other the date), they should align. This means that we can use the <code>stack()</code> function to create a RasterStack.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>rst_stack <span class="ot">&lt;-</span> <span class="fu">stack</span>(<span class="fu">dir_ls</span>(<span class="fu">path</span>(dest, <span class="st">"Zambia"</span>, <span class="st">"VI_Monthly_1Km_v6"</span>, <span class="st">"NDVI"</span>)))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rst_stack)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>


<!-- -->

</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{millar2022,
  author = {Justin Millar},
  title = {Downloading {MODIS} Raster Data in {R} with {MODIStsp}},
  date = {2022-07-25},
  url = {https://PATH-Global-Health.github.io/MNTD-tech-docs//posts/modistsp},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-millar2022" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Justin Millar. 2022. <span>“Downloading MODIS Raster Data in R with
MODIStsp.”</span> July 25, 2022. <a href="https://PATH-Global-Health.github.io/MNTD-tech-docs//posts/modistsp">https://PATH-Global-Health.github.io/MNTD-tech-docs//posts/modistsp</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="PATH-Global-Health/MNTD-tech-docs" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb9" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Downloading MODIS raster data in R with MODIStsp"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Justin Millar"</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "7/25/2022"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [remote sensing, R, raster]</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "thumbnail.jpg"</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Installation and setup</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">`MODIStsp` package</span><span class="co">](https://docs.ropensci.org/MODIStsp/)</span> provides an R interface to the raster images derived from MODIS Land Products data. This package provides an interactive user interface, as well as functions for programmatic queries for the time-series rasters. Note that this library requires and active internet connection.</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>Before installing the package, be sure that you have an NASA EarthData account, which is free and can be created at <span class="ot">&lt;https://urs.earthdata.nasa.gov/home&gt;</span>.</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>Once you have an active account, you can install the MODIStsp package directly from CRAN.</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"MODIStsp"</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>You can also install the experimental version of the package from the <span class="co">[</span><span class="ot">MODIStsp Github repository</span><span class="co">](https://github.com/ropensci/MODIStsp/)</span>. The package has <span class="co">[</span><span class="ot">excellent documentation</span><span class="co">](https://docs.ropensci.org/MODIStsp/)</span>, including multiple example articles. The following sections will briefly demonstrate the interactive and non-interactive modes, but be sure to check the package documentation for more details!</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interactive interface</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>The main function in the <span class="in">`MODIStsp`</span> package is called <span class="in">`MODIStsp()`</span>. By default, running this function with any additional input will launch the interactive graphic user interface (GUI) in you web browser.</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MODIStsp)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Launch graphic interface </span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="fu">MODIStsp</span>()</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="al">![Screenshot of MODIStsp graphic user interface](dashboard.png)</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>This GUI will lead to step-by-step through the selection, processing, and outputting workflow.</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>Starting with the "Products and Layers" section, choose which MODIS product and remote sensed layers you wish to download. Multiple layers can be included for a selected product category. The ? mark icon provide useful information on the various inputs, and the book button next to the Product Name menu will link to the NASA product documentation page, which will contains further details for that product including units, resolution, and aggregation scale factor.</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>Once the products layers have been selected, move onto the "Spatial/Temporal option" section. Here you can select the time range, projection, and spatial extent. Spatial parameters can be defined by tile selection, bounding box, uploading a shapefile, or by drawing on an interactive map.</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>Next, move to the "Output Format and Folders" section. This is where you will provide your NASA EarthData user information, and set the destination for your output files. You can use the "Browse" button to selection the output folder on your computer.</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>Once you have filled out each section you can press the "Run MODIStsp" button on the left menu. This will execute your query and process the download. Download times will depend on your input parameters and internet connection.</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a><span class="fu">## Programmatic mode</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>While the interactive GUI approach may be useful for individual data pulls, you may want to programmatic define your download parameters. This is especially useful to embed within code for analysis, as it serves as documentation and improves reproducibility.</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>The package documentation also provides an <span class="co">[</span><span class="ot">article for using the programmatic approach</span><span class="co">](https://docs.ropensci.org/MODIStsp/articles/noninteractive_execution.html)</span>. This uses the same <span class="in">`MODIStsp()`</span> function, expect now we have to provide the inputs that we would have used in the GUI directly into the function.</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>Here is an example for getting monthly NDVI and EVI rasters for Zambia 2021. First we still start by downloading a shapefile for Zambia.</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)         <span class="co"># File management package</span></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)         <span class="co"># Spatial data package</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)     <span class="co"># Raster data package</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MODIStsp)   <span class="co"># MODIS package</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  <span class="co"># Data process and viz</span></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a temporary folder for downloaded files</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>dest <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Download shapefile for Zambia</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>shp_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://raw.githubusercontent.com/"</span>, </span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"PATH-Global-Health/geometries/main/adm0/Zambia/adm0.json"</span>)</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="at">url =</span> shp_url, <span class="at">destfile =</span> <span class="fu">path</span>(dest, <span class="st">"Zambia.json"</span>))</span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>shp <span class="ot">&lt;-</span> <span class="fu">st_geometry</span>(<span class="fu">st_read</span>(<span class="fu">path</span>(dest, <span class="st">"Zambia.json"</span>), <span class="at">quiet =</span> T))</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shp)</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>In this example I created a temporary folder (using the <span class="in">`tempdir()`</span>) and saved it's "path" into an object called <span class="in">`dest`</span>. This is where we will download rasters and other metadata files. You can swap <span class="in">`tempdir()`</span> with a file path to a location on your computer.</span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>Next, use the <span class="in">`MODIStsp()`</span> function to download rasters by setting each parameter within the function. Here is the code for download monthly NDVI and EVI raster for 2021 at a 1 kilometer resolution.</span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>:::{.callout-warning}</span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a><span class="fu">## Time consuming function</span></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>This function may take several minutes or longer to run depending on the number of rasters, their sizes and resolutions, and your internet. Setting <span class="in">`parallel = TRUE`</span> can help speed up the download.</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>user <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"MODISUSER"</span>)</span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>pass <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"MODISPASS"</span>)</span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a><span class="co"># user and pass are set based on NASA EarthData account credentials</span></span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a><span class="fu">MODIStsp</span>(</span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a>  <span class="at">gui             =</span> <span class="cn">FALSE</span>,</span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">out_folder      =</span> dest,</span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">selprod         =</span> <span class="st">"Vegetation_Indexes_Monthly_1Km (M*D13A3)"</span>,</span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">bandsel         =</span> <span class="fu">c</span>(<span class="st">"NDVI"</span>, <span class="st">"EVI"</span>),</span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">sensor          =</span> <span class="st">"Terra"</span>,</span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">spatmeth        =</span> <span class="st">"file"</span>,</span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">spafile         =</span> <span class="fu">path</span>(dest, <span class="st">"Zambia.json"</span>),</span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_proj     =</span> <span class="st">"+proj=longlat +datum=WGS84 +no_defs"</span>,</span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_date      =</span> <span class="st">"2021.01.01"</span>,</span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_date        =</span> <span class="st">"2021.12.31"</span>,</span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">user            =</span> user,</span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">password        =</span> pass,</span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose         =</span> <span class="cn">FALSE</span>,</span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel        =</span> <span class="cn">TRUE</span></span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a>There are a lot of details, but remeber that we have to supply everything that we would have clicked in the GUI. The benefit of this approach is that we can save it in a script, which means the our process is documented and repeatable.</span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a><span class="fu">### Defining product, layers, and sensor</span></span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a>We need to tell R which <span class="co">[</span><span class="ot">MODIS product</span><span class="co">](https://modis.gsfc.nasa.gov/data/dataprod/)</span> and which specific layers from that product we want to download. We do this using the <span class="in">`selprod`</span> and <span class="in">`bandsel`</span> arguments, respectively. We can only select one MODIS product at a time, but we can download multiple layers from that product at once.</span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a>You can use the <span class="in">`MODIStsp_get_prodnames()`</span> function to list the available MODIS products, and the <span class="in">`MODIStsp_get_prodlayers()`</span> function to get a list of available layers.</span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a>Finally, we can choose to select layers from either the <span class="co">[</span><span class="ot">Terra</span><span class="co">](https://terra.nasa.gov/about/terra-instruments)</span> or <span class="co">[</span><span class="ot">Aqua</span><span class="co">](https://oceancolor.gsfc.nasa.gov/data/aqua/)</span> sensors. The default is to pull from both (if both are available), which is fine but may be unnecessary and will take extra time then selecting an individual sensor.</span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a><span class="fu">### Defining spatial extent and projection</span></span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a>Similar to the GUI, there are multiple options for defining the spatial extent, include using a local shapefile (<span class="in">`"file"`</span>), the bounding box of a spatial object (<span class="in">`"bbox"`</span>), or specific tile number from the <span class="co">[</span><span class="ot">MODIS Grid</span><span class="co">](https://modis-land.gsfc.nasa.gov/MODLAND_grid.html)</span> (<span class="in">`"tile"`</span>). While each approach is viable, I've had the most success with the <span class="in">`"file"`</span> method.</span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a>We can also set the geographic projection for the rasters using the <span class="in">`output_proj`</span> argument. This is helpful if the default projection from MODIS does not match other spatial data, such as our shapefile.</span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a><span class="fu">### Defining time frame and user credentials</span></span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a>Next, we state the time frame for our raster pulls. The number of raster files that will be download within this time frame will depend on the selected product. The input format is a character string with the format <span class="in">`"YYYY-MM-DD"`</span>, not an <span class="in">`as.Date()`</span> or lubridate-style date.</span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a>We also need to supply your username and password for your NASA EarthData account. In this example, I save this information into variables called <span class="in">`user`</span> and <span class="in">`pass`</span>, which I defined directly in the R Console rather than in my script, that way any personal credential information is not saved within my script.</span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a>Finally, there are many additional arguments that can be included. Some helpful ones are <span class="in">`verbose = TRUE`</span>, which will print information in your Console during through downloading, and <span class="in">`parallel = TRUE`</span>, which will speed up the download by using multiple CPU cores.</span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true" tabindex="-1"></a><span class="fu">### Loading and plotting data</span></span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-163"><a href="#cb9-163" aria-hidden="true" tabindex="-1"></a>Let's data a look at the files in our <span class="in">`dest`</span> output folder. Since we defined the extent using a shapefile called <span class="in">`Zambia.json`</span>, the <span class="in">`MODIStsp()`</span> function created a new folder called <span class="in">`Zambia`</span> and stored all the of results here. These are all of the raster files that we downloaded.</span>
<span id="cb9-164"><a href="#cb9-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true" tabindex="-1"></a><span class="fu">dir_ls</span>(<span class="fu">path</span>(dest, <span class="st">"Zambia"</span>), <span class="at">recurse =</span> T, <span class="at">type =</span> <span class="st">"file"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">path_rel</span>(dest)  <span class="co"># This function returns the "relative" path</span></span>
<span id="cb9-170"><a href="#cb9-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-171"><a href="#cb9-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-172"><a href="#cb9-172" aria-hidden="true" tabindex="-1"></a>Here we can see more of the default naming conventions. Inside the <span class="in">`Zambia`</span> folder we have a JSON file the contains the details for the API call that downloaded our raster, and a folder called <span class="in">`VI_Monthly_1Km_v6`</span>, which matches our selected MODIS product. Inside <span class="in">`VI_Monthly_1Km_v6`</span> there are two folders, <span class="in">`NDVI`</span> and <span class="in">`EVI`</span>, which are the bandnames for our selected layers. Inside these subfolders, there are 12 <span class="in">`.tif`</span> raster files. The naming convention for these files is <span class="in">`PRODNAME_PRODLAYER_YYYY_DDD.tif`</span> where <span class="in">`DDD`</span> refers to the Julian calendar date (1 to 365) for the starting date for that layer.</span>
<span id="cb9-173"><a href="#cb9-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-174"><a href="#cb9-174" aria-hidden="true" tabindex="-1"></a>There is also a <span class="in">`Time_Series`</span> subfolder, which contains a <span class="in">`.RData`</span> file containing a RasterStack object for each layer. Loading this file with <span class="in">`load()`</span> will an load this object with the default name of <span class="in">`raster_ts`</span> .</span>
<span id="cb9-175"><a href="#cb9-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-176"><a href="#cb9-176" aria-hidden="true" tabindex="-1"></a>We can load individual rasters into R, and use them from plotting and/or further analysis.</span>
<span id="cb9-177"><a href="#cb9-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-180"><a href="#cb9-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-181"><a href="#cb9-181" aria-hidden="true" tabindex="-1"></a><span class="co"># Load one raster file from the "NDVI" folder</span></span>
<span id="cb9-182"><a href="#cb9-182" aria-hidden="true" tabindex="-1"></a>rst <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">dir_ls</span>(<span class="fu">path</span>(dest, <span class="st">"Zambia"</span>, <span class="st">"VI_Monthly_1Km_v6"</span>, <span class="st">"NDVI"</span>))[<span class="dv">1</span>])</span>
<span id="cb9-183"><a href="#cb9-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-184"><a href="#cb9-184" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb9-185"><a href="#cb9-185" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rst)</span>
<span id="cb9-186"><a href="#cb9-186" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shp, <span class="at">add =</span> T, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb9-187"><a href="#cb9-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-188"><a href="#cb9-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-189"><a href="#cb9-189" aria-hidden="true" tabindex="-1"></a>You might notice that the values for this raster are much larger than we would expect for NDVI (which ranges from -1 to 1). If we look in the <span class="co">[</span><span class="ot">MODIS Data Catalog</span><span class="co">](https://lpdaac.usgs.gov/product_search/)</span> for the <span class="co">[</span><span class="ot">documentation on this layer</span><span class="co">](https://lpdaac.usgs.gov/products/mod13a3v006/)</span> we can see that the scale factor for the NDVI layer is 0.0001, meaning that we will want to multiple the raster values by this constant to return the actual values. Next time we pull this raster layer using <span class="in">`MODIStsp()`</span> we may want to set the <span class="in">`scale_val`</span> argument to 0.0001 to make this adjustment automatically.</span>
<span id="cb9-190"><a href="#cb9-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-191"><a href="#cb9-191" aria-hidden="true" tabindex="-1"></a>Finally, since all of the rasters are pulled using the same criteria (other the date), they should align. This means that we can use the <span class="in">`stack()`</span> function to create a RasterStack.</span>
<span id="cb9-192"><a href="#cb9-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-195"><a href="#cb9-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-196"><a href="#cb9-196" aria-hidden="true" tabindex="-1"></a>rst_stack <span class="ot">&lt;-</span> <span class="fu">stack</span>(<span class="fu">dir_ls</span>(<span class="fu">path</span>(dest, <span class="st">"Zambia"</span>, <span class="st">"VI_Monthly_1Km_v6"</span>, <span class="st">"NDVI"</span>)))</span>
<span id="cb9-197"><a href="#cb9-197" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rst_stack)</span>
<span id="cb9-198"><a href="#cb9-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>